# 离线模式使用指南

## ✅ 现在支持完全离线编译和运行！

本项目现在支持**完全离线**的C++编译和运行，无需任何网络连接。

## 🎯 功能说明

### 在线模式 vs 离线模式

| 功能 | 在线模式（有网络） | 离线模式（无网络） |
|------|------------------|------------------|
| **编译器** | Piston API（完整C++支持） | 内置解释器（基本C++语法） |
| **编译速度** | 快（服务器端） | 快（浏览器内） |
| **标准库支持** | ✅ 完整支持 | ⚠️ 部分支持 |
| **复杂语法** | ✅ 完全支持 | ⚠️ 基本语法 |
| **输入输出** | ✅ 支持 | ✅ 支持 |
| **隐私保护** | 代码发送到服务器 | ✅ 代码完全本地 |

### 自动切换

IDE会**自动检测**网络状态：
- ✅ **有网络**：自动使用在线API，获得完整功能
- ✅ **无网络**：自动切换到离线模式，继续工作

无需手动配置！

## 📝 离线模式支持的C++语法

### ✅ 完全支持

```cpp
// 1. 基本程序结构
#include <iostream>
using namespace std;

int main() {
    return 0;
}

// 2. 变量声明和赋值
int a = 10;
int b = 20;
int sum = a + b;

// 3. 输出 (cout)
cout << "Hello, World!" << endl;
cout << "数字: " << a << endl;

// 4. 输入 (cin)
int x;
cin >> x;
cout << "你输入的是: " << x << endl;

// 5. 基本运算
int result = a + b;
int product = a * b;
```

### ⚠️ 部分支持（正在改进）

- 复杂的控制流（if-else, for, while） - 基本支持
- 函数定义 - 仅支持main函数
- 数组和字符串 - 基本支持
- 指针和引用 - 不支持

## 🚀 使用方法

### 1. 正常使用（有网络）

```
1. 打开IDE
2. 编写代码
3. 点击"运行"
4. 自动使用在线API编译运行
```

### 2. 离线使用（无网络）

```
1. 打开IDE（需要先有网络加载页面）
2. 断开网络
3. 编写代码
4. 点击"运行"
5. 自动切换到离线模式
6. 看到提示："编译器模式: 离线模式（无需网络）"
```

### 3. 完全离线部署（PWA）

如果想实现完全离线（包括首次加载），可以：

1. **配置Service Worker**（PWA）
2. **下载所有资源**到本地
3. **首次访问时缓存**所有文件

## 💡 使用建议

### 教学场景推荐

- **课堂练习**：使用离线模式，不依赖网络
- **作业提交**：使用在线模式，获得完整功能
- **家庭学习**：自动切换，灵活使用

### 离线模式适用场景

✅ **适合**：
- 基本语法学习
- 简单算法练习
- 变量和IO操作
- 基础程序逻辑

❌ **不适合**：
- 复杂项目开发
- 需要使用完整标准库
- 高级C++特性

## 🔧 技术实现

### 离线编译器架构

```
用户代码
    ↓
语法检查（JavaScript）
    ↓
代码解析（JavaScript解析器）
    ↓
执行引擎（JavaScript虚拟机）
    ↓
输出结果
```

### 文件结构

- `scripts/offlineCompiler.js` - 离线编译器核心
- `scripts/compiler.js` - 编译器管理器（自动切换）

## ❓ 常见问题

**Q: 离线模式为什么功能有限？**
A: 为了保持轻量级和快速响应，离线模式专注于教学常用的基本语法。完整功能请使用在线模式。

**Q: 可以自己扩展离线编译器吗？**
A: 可以！编辑 `scripts/offlineCompiler.js`，添加更多语法支持。

**Q: 离线模式的性能如何？**
A: 对于基本程序，性能与在线模式相当，甚至更快（无网络延迟）。

**Q: 离线模式安全吗？**
A: 非常安全！代码完全在浏览器本地执行，不会发送到任何服务器。

## 🎓 教学示例

### 示例1：Hello World

```cpp
#include <iostream>
using namespace std;

int main() {
    cout << "Hello, World!" << endl;
    return 0;
}
```

✅ **在线模式**：完全支持  
✅ **离线模式**：完全支持

### 示例2：输入输出

```cpp
#include <iostream>
using namespace std;

int main() {
    int a, b;
    cin >> a >> b;
    cout << "和是: " << a + b << endl;
    return 0;
}
```

✅ **在线模式**：完全支持  
✅ **离线模式**：完全支持

### 示例3：简单计算

```cpp
#include <iostream>
using namespace std;

int main() {
    int x = 10;
    int y = 20;
    int sum = x + y;
    cout << x << " + " << y << " = " << sum << endl;
    return 0;
}
```

✅ **在线模式**：完全支持  
✅ **离线模式**：完全支持

## 📚 更多信息

- [完整README](README.md)
- [WASM编译器指南](WASM_COMPILER_GUIDE.md)
- [快速开始](QUICK_START.md)
